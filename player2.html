<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>gamebois</title>
        <link rel="icon" type="image/gif" href="/gamebois/imageAssets/gameboislogo512.gif"/>
        <link rel="stylesheet" type="text/css" href="main.css">
    </head>
    <body class = "player">
        <div class="container" id="player" style="margin:auto; width:100%; height:100%; max-width:100%; max-height:90%;">
            <a href="index.html">[home] </a>
            <br>
            <div class="game" id="game"></div>
        </div>
        
        <!--This is a new loading system that will allow html and other game types to play as well-->
        <script type="text/javascript">
            emujstypes = ["nds", "gb", "gbc", "gba"]
            const gamename = new URLSearchParams(window.location.search).get('game')
            const type = new URLSearchParams(window.location.search).get('type')
            const zippedGames = ["nds", "gb", "gbc", "gba"]

            var previous = {game:gamename, type:type}
            localStorage.setItem('previous', JSON.stringify(previous))

            if (emujstypes.includes(type)){
                var directory = "games/";
                var game = String(directory) + String(type) + "/" + String(gamename) + ".zip"
                //style="margin:auto; width:auto; height:90%; max-width:100%"

                EJS_startOnLoaded = true;
                EJS_color = '#88c070'
                EJS_player = '#game';
                EJS_biosUrl = '';
                EJS_gameUrl = game; // Url to Game rom
                EJS_core = type;
                EJS_pathtodata = 'data/'; //path to all of the wasm and js files. MUST all be in the same directory!!

                player = document.createElement("script")
                player.src = "data/loader.js"
                document.body.appendChild(player)
            } else {
                if (type=="turbo") {
                    var url = "https://turbowarp.org/" + gamename + "/embed"
                    var game = document.createElement("iframe")
                    var player = document.getElementById("player")
                    game.setAttribute("src", url)
                    game.setAttribute("width", "auto")
                    game.setAttribute("max-width", "100%")
                    game.setAttribute("height", "90%")
                    game.setAttribute("allowtransparency", "true")
                    game.setAttribute("frameborder", "0")
                    game.setAttribute("scrolling", "no")
                    game.setAttribute("allowfullscreen", "true")
                    player.appendChild(game)

                    br = document.createElement("br")
                    player.appendChild(br)

                    var link = "/gamebois/webplayer.html?type=scratch&game=" + gamename
                    const a = document.createElement("a");
                    const text = "If this isn't loading use this link";
                    a.innerHTML = "click here if game doesnt work";
                    a.href = link
                    player.appendChild(a);
                    a.className = "a"
                }
                if (type=="scratch") {
                    var url = "https://scratch.mit.edu/projects/embed/" + gamename + "/?autostart=false"
                    var game = document.createElement("iframe")
                    game.setAttribute("src", url)
                    game.setAttribute("width", "auto")
                    game.setAttribute("max-width", "100%")
                    game.setAttribute("height", "90%")
                    game.setAttribute("allowtransparency", "true")
                    game.setAttribute("frameborder", "0")
                    game.setAttribute("scrolling", "no")
                    game.setAttribute("allowfullscreen", "true")
                    player.appendChild(game)

                    br = document.createElement("br")
                    player.appendChild(br)

                    var link = "gamebois/webplayer.html?type=turbo&game=" + gamename
                    const a = document.createElement("a");
                    a.setAttribute("href", link);
                    const text = "If this isn't loading use this link";
                    a.innerHTML = ">click here for better performance (may be blocked)";
                    a.href = link
                    player.appendChild(a);
                    a.className = "a"
                }
            }
        </script>
        <script src="data/loader.js"></script>
    </body>
</html>
